let ContactModel,moment;_474‍.x([["addContact",()=>addContact],["getContacts",()=>getContacts]]);_474‍.w("../Models/contact",[["default",["ContactModel"],function(v){ContactModel=v}]]);_474‍.w("moment",[["default",["moment"],function(v){moment=v}]]);



const getWrap = ( status, msg, json ) =>{
  return ({  
    status: status,
    results: json.length,
    message: msg,
    data: json})
} 


        const addContact = async (req, res) => {
  try {    

      const str  = JSON.stringify(req.body)
      const data = JSON.parse(str)          
      const now =  moment().format("DD-MM-YYYY HH:mm:ss") 

      const doc =  {
        email: data.email,
        message: data.message,
        date: now
      }

      const contact = new ContactModel(doc)
      await contact.save()
      res.status(200).json({"status":"ok"})   
  } catch (error) {
      res.status(404).json( error)
  }
}


       const getContacts = async (req, res) => {
  try {
    const contacts = await ContactModel.find({})
    res.status(200).send( getWrap(200, "get contacts", contacts) )
  } catch (error) {
    res.status(404).send(error)
  }
}


